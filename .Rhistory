plot(mod2)
tmp = predict(mod, X)
plot(y, apply(predict(mod, X), 2, mean))
plot(y, apply(predict(mod2, X), 2, mean))
plot(y, apply(predict(mod, X), 1, mean))
plot(mod2)
BASS:::plot.bass
x <- mod
mod$M
length(mod$M)
ts.plot(mod$M,
xlab="MCMC iteration (post-burn)",
ylab="number of basis functions")
ts.plot(x$M,
xlab="MCMC iteration (post-burn)",
ylab="number of basis functions")
ts.plot(x$w)
x$w
predict(mod)
ts.plot(mod$ss)
document()
x <- gbass(X, y)
document()
yhat <- apply(predict(x), 2, mean)
document()
document()
yhat <- apply(predict(x), 2, mean)
document()
yhat <- apply(predict(x), 2, mean)
x
mod <- x
mod$X = X
mod$y = y
yhat <- apply(predict(x), 2, mean)
document()
yhat <- apply(predict(x), 2, mean)
BASS::predict.bass
BASS:::predict.bass
BASS:::plot.bass
yhat <- apply(predict(x), 2, mean)
plot(x$y, yhat,
xlab="observed"
ylab="posterior mean",
plot(x$y, yhat,
xlab="observed",
ylab="posterior mean",
main="Training Fit")
plot(mod2)
document()
plot(x)
class(X)
class(x)
plot(x)
plot.gbass(x)
?plot
plot.bass
BASS:::plot.bass
?BASS:::plot.bass
document()
plot.gbass(x)
class(x)
plot(x)
document()
plot(x)
?tbass
tbass
document()
?build_GIG
X <- lhs::maximinLHS(1000, 2)
y <- apply(X, 1, ff1)
mod <- gbass(X, y, maxInt=2)
document()
X <- lhs::maximinLHS(1000, 2)
y <- apply(X, 1, ff1)
mod <- gbass(X, y, maxInt=2)
plot(mod)
?gbass
sig <- sqrt(mean(mod$w))
sig
curve(dt(x/sig, 15)/sig, add=TRUE, col='blue')
y
var(y)
?gbass
w_prior <- build_GIG(0, 0, 0)
w_prior$lb <- 0
mod <- gbass(X, y, maxInt=2, w_prior=w_prior)
plot(mod)
curve(dgamma(x, 3, 1.5))
curve(dgamma(x, 3, 1.5), to=10)
curve(dgamma(x, 3, 1))
curve(dgamma(x, 3, 1), to=10)
curve(dgamma(x, 1.5, 1), to=10)
mean(rgamma(1000, 1.5, 1))
sd(rgamma(1000, 1.5, 1))
y <- apply(X, 1, ff1) + (rgamma(1000, 1.5, 1) - 1.5)/6
w_prior <- build_GIG(0, 0, 0)
w_prior$lb <- 0
mod <- gbass(X, y, maxInt=2, w_prior=w_prior)
w_prior <- build_GIG(0, 0, 0)
w_prior$lb <- 0
mod <- gbass(X, y, maxInt=2, w_prior=w_prior)
plot(mod)
plot(mod)
qmod <- qbass(X, y, q=0.75)
y <- apply(X, 1, ff1)*6 + (rgamma(1000, 1.5, 1) - 1.5)
w_prior <- build_GIG(0, 0, 0)
w_prior$lb <- 0
qmod <- qbass(X, y, q=0.75, w_prior=w_prior)
predict(qmod)
tmp <- predict(qmod)
dim(tmp)
plot(y, apply(qmod, 2, mean))
plot(y, apply(predict(qmod), 2, mean))
plot(y, apply(predict(qmod), 2, mean) + qgamma(0.75, 1.5, 1) - 1)
abline(0, 1)
abline(0, 1, col='red')
plot(qmod)
plot(qmod)
class(qmod)
document()
plot(qmod)
plot(y, apply(predict(qmod), 2, mean))
abline(0, 1, col='red')
plot(y, apply(predict(qmod), 2, mean) + qgamma(0.75, 1.5, 1) - 1)
abline(0, 1, col='red')
+ qgamma(0.75, 1.5, 1) - 1
plot(qmod)
document()
plot(qmod)
var(y)/scale/2
var(y)/2
w_prior$prop_sigma <- 0.1
qmod <- qbass(X, y, q=0.75, w_prior=w_prior)
plot(qmod)
plot(y, apply(predict(qmod), 2, mean))
abline(0, 1, col='red')
plot(y, apply(predict(qmod), 2, mean) + qgamma(0.75, 1.5, 1) - 1)
abline(0, 1, col='red')
plot(y, apply(predict(qmod), 1, mean))
abline(0, 1, col='red')
plot(y, apply(predict(qmod), 2, mean))
abline(0, 1, col='red')
plot(y, apply(predict(qmod), 2, mean) + qgamma(0.75, 1.5, 1) - 1)
abline(0, 1, col='red')
plot(y + qgamma(0.75, 1.5, 1) - 1, apply(predict(qmod), 2, mean) )
abline(0, 1, col='red')
plot(y, apply(predict(qmod), 2, mean))
abline(0, 1, col='red')
plot(y + qgamma(0.75, 1.5, 1) - 1, apply(predict(qmod), 2, mean) )
abline(0, 1, col='red')
?gbass
qmod <- qbass(X, y, q=0.75, w_prior=w_prior, a_lambda=1, b_lambda=0.01)
plot(y, apply(predict(qmod), 2, mean))
abline(0, 1, col='red')
plot(y + qgamma(0.75, 1.5, 1) - 1, apply(predict(qmod), 2, mean))
abline(0, 1, col='red')
plot(qmod)
?ff
?func
?ff1
X <- lhs::maximinLHS(1000, 2)
y <- apply(X, 1, ff4)*6 + (rgamma(1000, 1.5, 1) - 1.5)
w_prior <- build_GIG(0, 0, 0)
w_prior$lb <- 0
mod <- gbass(X, y, maxInt=2, w_prior=w_prior)
plot(mod)
w_prior <- build_GIG(0, 0, 0)
w_prior$lb <- 0
w_prior$prop_sigma <- 0.1
qmod <- qbass(X, y, q=0.75, w_prior=w_prior, a_lambda=1, b_lambda=0.01)
plot(y, apply(predict(qmod), 2, mean))
abline(0, 1, col='red')
plot(y + qgamma(0.75, 1.5, 1) - 1, apply(predict(qmod), 2, mean))
abline(0, 1, col='red')
plot(mod)
Xt <- lhs::maximinLHS(500, 2)
yt <- apply(Xt, 1, ff4)
yhat <- apply(predict(qmod, 2, mean))
yhat <- apply(predict(qmod, Xt), 2, mean))
yhat <- apply(predict(qmod, Xt), 2, mean)
plot(yhat, yt)
plot(yt, yhat)
abline(0, 1, col='red')
Xt <- lhs::maximinLHS(500, 2)
yt <- apply(Xt, 1, ff4)
yhat <- apply(predict(qmod, Xt), 2, mean)
plot(yhat, yt)
abline(0, 1, col='red')
yt <- apply(Xt, 1, ff4)*6
plot(yt, yhat)
abline(0, 1, col='red')
plot(yt + qgamma(0.75, 1.5, 1) - 1.5, yhat)
abline(0, 1, col='red')
plot(yt, yhat)
abline(0, 1, col='red')
plot(yt + qgamma(0.75, 1.5, 1) - 1.5, yhat)
abline(0, 1, col='red')
crossprod
?crossprod
?tcrossprod
tmp <- matrix(rnorm(25), nrow=5)
crossprod(runif(5), tmp)
t(runif(5))%*%tmp
?nburn
?gbass
2000 - 1001
X <- lhs::maximinLHS(300, 2)
y <- apply(X, 1, ff1)
mod <- gbass(X, y, nmcmc=2000, nburn=1001)
document()
document()
document()
document()
library(GBASS)
X <- lhs::maximinLHS(300, 2)
y <- apply(X, 1, ff1)
mod <- gbass(X, y, nmcmc=2000, nburn=1001)
plot(mod)
mod <- gbass(X, y, nmcmc=5000, nburn=4001)
plot(mod)
library(GBASS)
X <- lhs::maximinLHS(300, 2)
y <- apply(X, 1, ff1)
mod <- gbass(X, y, nmcmc=2000, nburn=1001)
yhat <- apply(predict(mod), 2, mean)
d1 <- sqrt(mean((y-yhat)^2))
d1
plot(mod)
hist(rgamma(1000, 1.2, 1))
(qgamma(0.75, 1.5, 1) - 1.5)
X2 <- lhs::maximinLHS(100, 2)
X <- lhs::maximinLHS(300, 2)
y <- 6*apply(X, 1, ff1) + (rgamma(300, 1.5, 1) - 1.5)
mod <- qbass(X, y, q=0.75,
nmcmc=2000, nburn=1001)
plot(mod)
yhat <- apply(predict(mod, X2)
, 2, mean)
X2 <- lhs::maximinLHS(100, 2)
y2 <- 6*apply(X2, 1, ff1) + (qgamma(0.75, 1.5, 1) - 1.5)
yhat <- apply(predict(mod, X2)
, 2, mean)
d1 <- sqrt(mean((y-yhat)^2))
d1
plot(y2, yhat)
abline(0, 1)
abline(0, 1, col='red')
X2 <- lhs::maximinLHS(100, 2)
y2 <- 6*apply(X2, 1, ff1)
yhat <- apply(predict(mod, X2)
, 2, mean)
plot(y2, yhat)
abline(0, 1, col='red')
d1 <- sqrt(mean((y-yhat)^2))
d1
+ (qgamma(0.75, 1.5, 1) - 1.5)
d1 <- sqrt(mean((y2-yhat)^2))
d1
plot(y2, yhat)
abline(0, 1)
d1
y2 <- 6*apply(X2, 1, ff1) + (qgamma(0.75, 1.5, 1) - 1.5)
yhat <- apply(predict(mod, X2)
, 2, mean)
d1 <- sqrt(mean((y2-yhat)^2))
d1
nw_triangle()
nw_triangle
document()
X <- lhs::maximinLHS(1000, 2)
y <- apply(X, 1, ff4)*6 + (rgamma(1000, 1.5, 1) - 1.5)
mod2 <- nwbass(X, y)
mod2 <- nwbass(X, y, maxInt=2)
plot(mod2)
X <- lhs::maximinLHS(1000, 2)
y <- apply(X, 1, ff4)*6 + (rgamma(1000, 1.5, 1) - 1.5)
document()
library(devtools)
library(roxygen2)
document()
X <- lhs::maximinLHS(1000, 2)
y <- apply(X, 1, ff4)*6 + (rgamma(1000, 1.5, 1) - 1.5)
mod2 <- nwbass2(X, y, maxInt=2)
plot(mod2)
plot(mod2)
predict(mod2)
predict(mod2, X)
document()
document()
X <- lhs::maximinLHS(1000, 2)
y <- apply(X, 1, ff4)*6 + (rgamma(1000, 1.5, 1) - 1.5)
mod2 <- nwbass2(X, y, maxInt=2)
document()
X <- lhs::maximinLHS(1000, 2)
y <- apply(X, 1, ff4)*6 + (rgamma(1000, 1.5, 1) - 1.5)
mod2 <- nwbass2(X, y, maxInt=2)
plot(mod2)
ts.plot(mod2$beta)
ts.plot(mod2$gamma)
mod2 <- nwbass2(X, y, maxInt=2, m_beta=0, s_beta=1)
rMHN(100, 5, 3, 2)
document()
X <- lhs::maximinLHS(1000, 2)
y <- apply(X, 1, ff4)*6 + (rgamma(1000, 1.5, 1) - 1.5)
mod2 <- nwbass2(X, y, maxInt=2, m_beta=0, s_beta=1)
rmpon_sun
document()
mod2 <- nwbass2(X, y, maxInt=2, m_beta=0, s_beta=0.1)
mod2 <- nwbass2(X, y, maxInt=2, m_gamma = 1, s_gamma = 0.1)
ts.plot(mod2$gamma)
plot(mod2)
curve(dgamma(x-1.5, 1.5, 1))
curve(dgamma(x-1.5, 1.5, 1), add=TRUE)
curve(dgamma(x+1.5, 1.5, 1), add=TRUE)
mod2 <- nwbass2(X, y, maxInt=2, m_gamma = 1, s_gamma = 0.1, scale=1000)
mod2 <- nwbass2(X, y, maxInt=2, m_gamma = 1, s_gamma = 0.1, scale=1000, m_beta=0, s_beta=0.001)
plot(mod2)
15.48/2.7
5.3/0.6
8.5/1.8
library(GBASS)
library(BASS)
library(Matrix)
library(RColorBrewer)
library(TeachingDemos)
library(BART)
library(laGP)
library(quack)
bob <- brewer.pal(7, "Set1")
#====================================================
#         DATA SET 1: Concrete
#==================================================
set.seed(1111)
dat <- concrete
X <- X1 <- apply(dat[,1:8],2,BASS:::scale.range)
y <- dat[,9]
y1 <- y
mod1.1 <- bass(X, y, npart=5, nmcmc=nmcmc, nburn=nburn, thin=thin)
bob <- brewer.pal(7, "Set1")
nmcmc <- 50000
nburn <- 40001
thin <- 10
w_sig_list <- c(.15, .15, .2, .25, .3, .15, .3)
cnt <- 1
set.seed(1111)
dat <- concrete
X <- X1 <- apply(dat[,1:8],2,BASS:::scale.range)
y <- dat[,9]
y1 <- y
mod1.1 <- bass(X, y, npart=5, nmcmc=nmcmc, nburn=nburn, thin=thin)
mod1.2 <- tbass(X, y, npart=5, df=5, nmcmc=nmcmc, nburn=nburn, thin=thin, a_lambda=.1, b_lambda=.1)
mod1.3 <- nwbass(X, y, m_gamma = 100, s_gamma=35, m_beta=0, s_beta=3,
w_prior=list(type="GIG", p=-0.01, a=0, b=0.01, prop_sigma=w_sig_list[cnt]),
nmcmc=nmcmc, nburn=nburn, thin=thin, lag_beta=floor(nburn*0.75), npart=5, a_lambda=.1, b_lambda=.1)
cnt <- cnt + 1
mod1.4 <- gbart(X, y)
mod1.5 <- leapGP_build(X, y, H=min(100, 2*round(sqrt(length(y)))), scale=TRUE, n=2*round(sqrt(length(y))))
plot(mod1.3)
plot(mod1.1)
X <- lhs::maximinLHS(1000, 2)
y <- apply(X, 1, ff4)*6 + (rgamma(1000, 1.5, 1) - 1.5)
mod2 <- nwbass2(X, y, maxInt=2, m_gamma = 1, s_gamma = 0.1, scale=1000, m_beta=0, s_beta=0.001)
plot(mod2)
ts.plot(mod2$gamma)
ts.plot(mod2$beta)
abline(h=0, col='red')
?nwbass2
tmp = (rgamma(1000, 1.5, 1) - 1.5)
mean((tmp - mean(tmp))^3)/sd(tmp^3)
hist(tmp)
tmpz <- (tmp - mean(tmp))/sd(tmp)
mean(tmpz^3)
mod2 <- nwbass2(X, y, maxInt=2, m_gamma = 1, s_gamma = 0.1, scale=1000, m_beta=0, s_beta=1)
plot(mod2)
ts.plot(mod2$beta)
abline(h=0, col='red')
tts.plot(mod2$gamma)
ts.plot(mod2$gamma)
dnw
901/557
901/557*2
plot(mod2)
ts.plot(mod2$beta)
ts.plot(mod2$gamma)
curve(dt(x, 0.01), from=-10, to=10)
curve(dt(x, 0.001), from=-10, to=10)
curve(dt(x, 0.0001), from=-10, to=10)
curve(dt(x, 0.00001), from=-10, to=10)
rt(10000, 0.00001)
rt(10000, 0.1)
hist(rt(10000, 0.1))
integrate(dt, lower=-0.001, upper=0.001, df=0.001)
integrate(dt, lower=-0.001, upper=0.001, df=0.0005)
mod2b <- nwbass2(X, y, maxInt=2, m_gamma=100, s_gamma=35, scale=1000, m_beta=0, s_beta=1)
mod2b <- plot(mod2)
plot(mod2b)
mod2b <- nwbass2(X, y, maxInt=2, m_gamma=100, s_gamma=35, scale=1000, m_beta=0, s_beta=1)
plot(mod2)
plot(mod2b)
ts.plot(mod2b$beta)
plot(mod2b$gamma)
ts.plot(mod2b$gamma)
ts.plot(mod2$gamma)
library(GBASS)
GBASS::nw_gamma_prior(p1=.5, 0.05)
GBASS::nw_gamma_prior(p1=.5, p2=0.05)
GBASS::nw_gamma_prior(p1=.5, p2=0.00001)
GBASS::nw_gamma_prior(p1=.5, p2=0.00001)
GBASS::nw_gamma_prior(p1=.5, p2=0.00001)
GBASS::nw_gamma_prior(p1=.5, p2=0.1)
GBASS::nw_gamma_prior(p1=.5, p2=0.05)
curve(dbeta(x, 1, 1))
curve(dbeta(x, 5, 1))
curve(dbeta(x, 1, 5))
a = 1
b = 5
pbeta(0.1, 1, 5)
1 - pbeta(0.9, 1, 5)
nw_gamma_prior(p1=0.40951, 1e-5)
nw_gamma_prior(p1=0.40951, p2=1e-5)
nw_gamma_prior(p1=0.40951, p2=1e-5)
BETA <- 1
nw_gamma_prior(p1=pbeta(0.1, 1, BETA), p2=1 - pbeta(0.9, 1, BETA))
BETA <- 5
nw_gamma_prior(p1=pbeta(0.1, 1, BETA), p2=1 - pbeta(0.9, 1, BETA))
BETA <- 10
nw_gamma_prior(p1=pbeta(0.1, 1, BETA), p2=1 - pbeta(0.9, 1, BETA))
BETA <- 30
nw_gamma_prior(p1=pbeta(0.1, 1, BETA), p2=1 - pbeta(0.9, 1, BETA))
nw_gamma_prior(p1=pbeta(0.1, 1, BETA), p2=1 - pbeta(0.9, 1, BETA))
BETA <- 10
nw_gamma_prior(p1=pbeta(0.1, 1, BETA), p2=1 - pbeta(0.9, 1, BETA))
BETA <- 20
nw_gamma_prior(p1=pbeta(0.1, 1, BETA), p2=1 - pbeta(0.9, 1, BETA))
BETA <- 15
nw_gamma_prior(p1=pbeta(0.1, 1, BETA), p2=1 - pbeta(0.9, 1, BETA))
ww <- mean(mod2$w)
ww
ts.plot(mod2$w)
nn <- 1000
ww <- mean(mod2$w)
cc <- 1000
beta <- mean(mod2$beta)
xi <- rnorm(nn, 0, sqrt(cc))
?rgig2
?rgig2.vec
rgig2.vec
gamma < mean(mod2$gamma)
mean(mod2$gamma)
gamma < mean(mod2$gamma)
gamma <- mean(mod2$gamma)
nn <- 1000
ww <- mean(mod2$w)
cc <- 1000
beta <- mean(mod2$beta)
xi <- rnorm(nn, 0, sqrt(cc))
gamma <- mean(mod2$gamma)
vv <- rgig2.vec(-1/2, gamma^2, 1)
for(i in 1:nn){
vv[i] <- rgig2.vec(-1/2, gamma^2, 1)
}
epsilon <- sqrt(ww)*(beta*vv + sqrt(vv)*xi)
hist(epsilon)
par(mfrow=c(1,1))
hist((rgamma(100000, 1.5, 1) - 1.5), breaks=30, freq=F)
hist((rgamma(100000, 1.5, 1) - 1.5), breaks=30, freq=F, ylim=c(-10, 15))
hist((rgamma(100000, 1.5, 1) - 1.5), breaks=30, freq=F, xlim=c(-10, 15))
mean(epsilon)
hist(epsilon, add=TRUE, breaks=30, freq=F, col=adjustcolor('dodgerblue', alpha.f=0.2))
hist(epsilon - 1, add=TRUE, breaks=30, freq=F, col=adjustcolor('dodgerblue', alpha.f=0.2))
hist((rgamma(100000, 1.5, 1) - 1.5), breaks=30, freq=F, xlim=c(-10, 15))
hist(epsilon - 1, add=TRUE, breaks=30, freq=F, col=adjustcolor('dodgerblue', alpha.f=0.2))
hist((rgamma(100000, 1.5, 1) - 1.5), breaks=30, freq=F)X
X
dim(X)
dim(rbind(X, X))
dim(rbind(X, X, X))
dim(rbind(X, X, X, X))
dim(rbind(X, X, X, X, X))
hist(epsilon)
hist(epsilon, breaks=30)
X <- lhs::maximinLHS(200, 2)
X <- rbind(X, X, X, X, X)
n <- nrow(X)
y <- apply(X, 1, ff4)*6 + (rgamma(n, 1.5, 1) - 1.5)
mod2 <- nwbass2(X, y, maxInt=2, m_gamma = 1, s_gamma = 0.1, scale=1000, m_beta=0, s_beta=1)
X <- lhs::maximinLHS(200, 2)
X <- rbind(X, X, X, X, X)
n <- nrow(X)
y <- apply(X, 1, ff4)*6 + (rgamma(n, 1.5, 1) - 1.5)
#mod2 <- nwbass2(X, y, maxInt=2, m_gamma = 1, s_gamma = 0.1, scale=1000, m_beta=0, s_beta=1)
mod2b <- nwbass2(X, y, maxInt=2, m_gamma=90, s_gamma=25, scale=1000, m_beta=0, s_beta=1)
plot(mod2)
nn <- 1000
ww <- mean(mod2$w)
cc <- 1000
beta <- mean(mod2$beta)
xi <- rnorm(nn, 0, sqrt(cc))
gamma <- mean(mod2$gamma)
vv <- rep(NA, nn)
for(i in 1:nn){
vv[i] <- rgig2.vec(-1/2, gamma^2, 1)
}
epsilon <- sqrt(ww)*(beta*vv + sqrt(vv)*xi)
hist((rgamma(100000, 1.5, 1) - 1.5), breaks=30, freq=F, xlim=c(-10, 15))
hist(epsilon - 1, add=TRUE, breaks=30, freq=F, col=adjustcolor('dodgerblue', alpha.f=0.2))
hist((rgamma(100000, 1.5, 1) - 1.5), breaks=30, freq=F, xlim=c(-10, 15))
hist(epsilon - mean(epsilon), add=TRUE, breaks=30, freq=F, col=adjustcolor('dodgerblue', alpha.f=0.2))
par(mfrow=c(1,1))
hist((rgamma(100000, 1.5, 1) - 1.5), breaks=30, freq=F, xlim=c(-10, 15))
hist(epsilon - mean(epsilon), add=TRUE, breaks=30, freq=F, col=adjustcolor('dodgerblue', alpha.f=0.2))
ts.plot(mod2$beta)
